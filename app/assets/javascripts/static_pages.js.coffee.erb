# Place all the behaviors and hooks related to the matching controller here.
# All this logic will automatically be available in application.js.
# You can use CoffeeScript in this file: http://coffeescript.org/
$(document).ready ->
  
  #set opacity to 0.4 for all the images  
  #opacity = 1 - completely opaque  
  #opacity = 0 - invisible  
  $(".menu-custom img").css "opacity", 0.4
  
  # when hover over the selected image change the opacity to 1  
  $(".menu-custom li").hover (->
    $(this).find("img").stop().fadeTo "slow", 1
  ), ->
    $(this).find("img").stop().fadeTo "slow", 0.4

  $('#guardar-cambios-customapp').click (event) ->
    guardar_cambios()
#    alert($("#per-est-app").attr('src'))

$().ready ->
  $('.kwicks').kwicks
    maxSize: 100
    behavior: 'menu'
  $('.kwicks li').click (event) ->
    ele = document.getElementById(event.target.id)
    color = $(ele).css('background-color')
    col = new RGBColor(color)
    colhex = col.toHex_n()
    parte = event.target.id.charAt(6)

    switch parte
     when '0'
       changeEstanque colhex
     when '1'
       changeAplicacion colhex
     when '2'
       changeAsiento colhex
     when '3'
       changeManilla colhex

    #Usando la clase RGB color incluida en assets
    return
  return

changeEstanque = (color) ->
  $.ajax
          type: 'POST'
          url: "fetch_estanque"
          data:
            selected_value: color
            parte: 'estanque'
          dataType: "json"
          success: (data) ->
     #       alert data
            $('#per-est-app').fadeOut "fast", ->
              $(this).load ->
                $(this).fadeIn("slow")
              $('#per-est-app').attr src: data.per

            $('#lat-est-app').fadeOut "fast", ->
              $(this).load ->
                $(this).fadeIn("slow")
              $('#lat-est-app').attr src: data.lat

            $('#sup-est-app').fadeOut "fast", ->
              $(this).load ->
                $(this).fadeIn("slow")
              $('#sup-est-app').attr src: data.sup
            # alert data + ' | ' + s 
  return

changeAplicacion = (color) ->
  $.ajax
          type: 'POST'
          url: "fetch_aplicacion"
          data:
            selected_value: color
            parte: 'aplicacion'
          dataType: "json"
          success: (data) ->
            $('#per-apl-app').fadeOut "fast", ->
              $(this).load ->
                $(this).fadeIn("slow")
              $('#per-apl-app').attr src: data.per

            $('#lat-apl-app').fadeOut "fast", ->
              $(this).load ->
                $(this).fadeIn("slow")
              $('#lat-apl-app').attr src: data.lat

          # En la vista superior la aplicaciÃ³n del estanque no tiene visualizaciÃ³n.
  return

changeAsiento = (color) ->
  $.ajax
          type: 'POST'
          url: "fetch_asiento"
          data:
            selected_value: color
            parte: 'asiento'
          dataType: "json"
          success: (data) ->
            $('#per-asi-app').fadeOut "fast", ->
              $(this).load ->
                $(this).fadeIn("slow")
              $('#per-asi-app').attr src: data.per

            $('#lat-asi-app').fadeOut "fast", ->
              $(this).load ->
                $(this).fadeIn("slow")
              $('#lat-asi-app').attr src: data.lat

            $('#sup-asi-app').fadeOut "fast", ->
              $(this).load ->
                $(this).fadeIn("slow")
              $('#sup-asi-app').attr src: data.sup
  return

changeManilla = (color) ->
  $.ajax
          type: 'POST'
          url: "fetch_manilla"
          data:
            selected_value: color
            parte: 'manilla'
          dataType: "json"
          success: (data) ->
            $('#per-man-app').fadeOut "fast", ->
              $(this).load ->
                $(this).fadeIn("slow")
              $('#per-man-app').attr src: data.per

            $('#lat-man-app').fadeOut "fast", ->
              $(this).load ->
                $(this).fadeIn("slow")
            $('#lat-man-app').attr src: data.lat

            $('#sup-man-app').fadeOut "fast", ->
              $(this).load ->
                $(this).fadeIn("slow")
            $('#sup-man-app').attr src: data.sup
  return


guardar_cambios = ->
  $.ajax
          type: 'POST'
          url: custompath
          data:
            custom_app:
              est_per_file: $("#per-est-app").attr('src')
              est_lat_file: $("#lat-est-app").attr('src')
              est_sup_file: $("#sup-est-app").attr('src')
              apl_per_file: $("#per-apl-app").attr('src')
              apl_lat_file: $("#lat-apl-app").attr('src')
              apl_sup_file: $("#sup-apl-app").attr('src')
              asi_per_file: $("#per-asi-app").attr('src')
              asi_lat_file: $("#lat-asi-app").attr('src')
              asi_sup_file: $("#sup-asi-app").attr('src')
              man_per_file: $("#per-man-app").attr('src')
              man_lat_file: $("#lat-man-app").attr('src')
              man_sup_file: $("#sup-man-app").attr('src')
              lla_per_file: $("#per-lla-app").attr('src')
              lla_lat_file: $("#lat-lla-app").attr('src')
              lla_sup_file: $("#sup-lla-app").attr('src')
              foc_per_file: $("#per-foc-app").attr('src')
              foc_lat_file: $("#lat-foc-app").attr('src')
              foc_sup_file: $("#sup-foc-app").attr('src')
          dataType: "json"
          success: (data) ->
     #       alert data
  return
